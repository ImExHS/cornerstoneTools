<html>
	<head>

		<!-- include the hammer.js library for touch gestures-->
		<script src="https://unpkg.com/hammerjs@2.0.8/hammer.js"></script>
		<script src="https://unpkg.com/dicom-parser@1.8.3/dist/dicomParser.min.js"></script>

		<!-- include the cornerstone library -->
		<script src="https://unpkg.com/cornerstone-core"></script>
		<script src="https://unpkg.com/cornerstone-math"></script>
		<script src="https://unpkg.com/cornerstone-wado-image-loader"></script>

		<!-- Why we're all here ;) -->
		<!-- <script src="https://unpkg.com/cornerstone-tools@%5E4"></script> -->

		<script src="dist/cornerstoneTools.min.js"></script>

		<!-- include special code for these examples which provides images -->
		<!-- <script src="examples/imageLoader.js"></script> -->
	</head>
	<body>
		<div class="cornerstone-element-wrapper">
      <div id="cornerstone-element" class="cornerstone-element"></div>
		</div>
		<script>

			// Externals
			cornerstoneWADOImageLoader.external.cornerstone = cornerstone;
  		cornerstoneWADOImageLoader.external.dicomParser = dicomParser;			
			cornerstoneTools.external.cornerstoneMath = cornerstoneMath;
			cornerstoneTools.external.cornerstone = cornerstone;
			cornerstoneTools.external.Hammer = Hammer;

			const cTools = cornerstoneTools.init({mouseEnabled: true, showSVGCursors: true});
			const element = document.getElementById('cornerstone-element');
			cornerstone.enable(element);

			const imageIds = [
				'wadouri:http://127.0.0.1:8080/assets/dicom/1-01.dcm'
				//'wadouri:http://127.0.0.1:8080/assets/dicom/pt-01.dcm'				
			];

			const stack = {
				currentImageIdIndex: 0,
				imageIds: imageIds,
			};

			element.tabIndex = 0;
			element.focus();

			cornerstone.loadImage(imageIds[0]).then(function(image) {
				cornerstoneTools.addStackStateManager(element, ['stack']);
				cornerstoneTools.addToolState(element, 'stack', stack);
				cornerstone.displayImage(element, image);
			});

			cTools.addEnabledElement(element);

			const toolName = 'rectangleRoi';
			//const toolName = 'probe';

			// Add the tool
			cTools.addToolForElement(element, cornerstoneTools[`${toolName}Tool`]);
			cTools.setToolEnabledForElement(element, toolName);
			cTools.setToolActiveForElement(element, toolName, { mouseButtonMask: 1, isTouchActive: true, isMouseActive: true });

			// const test = cTools.getToolForElement(element, 'rectangleRoi');

		</script>
	</body>
</html>